---
title: "Data Cleaning for Analysis"
author: "Vorisek_CN"
date: "30 12 2021"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*Load relevant libraries*
```{r}
library(readxl)
```

## Bar themes
```{r}
# define theme and colors for barplots
bar_theme <-   theme(rect = element_blank(),
        axis.ticks.y = element_line(color = "grey40"),
        panel.grid.major.x = element_line(color = "grey90"))
bar_color <-  "#1b3051"
bar_width <- 0.6
```

*Read in file created in "Data_Preparation.Rmd"*
```{r}
merged <- read_excel("merged.xlsx")
View(merged)
```

### Entire Data
```{r}
nrow(merged)
ncol(merged)
```


# Delete Incomplete Datasets of AI Developers
## questionnaire 1 complete

```{r}
complete1 <- merged[merged$fragebogen_fairness_und_ki_complete == 2, ]
nrow(complete1)
```
```{r}
AIcomplete2 <- complete1[complete1$ki_entwicklung == 1 | complete1$ki_entwicklung == 2 | complete1$ki_entwicklung == 3, ]
nrow(AIcomplete2)
```
```{r}
complete2 <- AIcomplete2[AIcomplete2$fragebogen_fairness_und_ki_2_complete == 2, ]
nrow(complete2)
```
## response rate
```{r}
199/334*100
```
### KI Entwickler complete sheet 1?
1-3
```{r}
is.factor(complete1$ki_entwicklung)
```
```{r}
complete1$ki_entwicklung = as.factor(complete1$ki_entwicklung)
```

```{r}
developer <- complete1 %>% 
  group_by(ki_entwicklung) %>% 
  summarize(N = n()) %>% 
  mutate(Percent = N / sum(N) * 100,
         Percent = round(Percent, 1)) %>% 
  arrange(desc(N))

#Rename Variables
developer$ki_entwicklung <- factor(developer$ki_entwicklung,levels = c(1,2,3,4,5), labels = c("Yes","No, but I have worked on AI-projects in the past", "No, but I am planning on it", "No, never", "Not specified"))

knitr::kable(developer)
```

```{r}
ggplot(developer) + geom_col(aes(reorder(ki_entwicklung, N, sum), N),
                              fill = bar_color,
                              width = bar_width) +
  labs(x = "", y = "Sind Sie derzeit an einer KI-Entwicklung beteiligt?") +
  scale_y_continuous(breaks = seq(0,200,50)) +
  coord_flip() +
  bar_theme
```

## KI Entwickler complete all sheets?
```{r}
complete2$ki_entwicklung = as.factor(complete2$ki_entwicklung)
```

```{r}
developer <- complete2 %>% 
  group_by(ki_entwicklung) %>% 
  summarize(N = n()) %>% 
  mutate(Percent = N / sum(N) * 100,
         Percent = round(Percent, 1)) %>% 
  arrange(desc(N))

#Rename Variables
developer$ki_entwicklung <- factor(developer$ki_entwicklung,levels = c(1,2,3,4,5), labels = c("Yes","No, but I have worked on AI-projects in the past", "No, but I am planning on it", "No, never", "Not specified"))

knitr::kable(developer)
```

```{r}
ggplot(developer) + geom_col(aes(reorder(ki_entwicklung, N, sum), N),
                              fill = bar_color,
                              width = bar_width) +
  labs(x = "", y = "Sind Sie derzeit an einer KI-Entwicklung beteiligt?") +
  scale_y_continuous(breaks = seq(0,200,50)) +
  coord_flip() +
  bar_theme
```

## Identify additional Incomplete IDs

















*select columns*
```{r}
which(colnames(AIcomplete2) == "ki_trainingsdaten___1")
which(colnames(AIcomplete2) == "ki_trainingsdaten___4")
```
*create dataset*
```{r}
train2<-AIcomplete2 %>% select(1, 97:100)
view(train2)
ncol(train2)
```

**identify participants which did not answer this question but were marked as complete!!!**
```{r}
train2 <- train2 %>%
    mutate(nonresp = select(., 2:5) %>% rowSums(na.rm = TRUE))
incomplete7 <- train2[train2$nonresp == 0, ]
incomplete7$id
```























































